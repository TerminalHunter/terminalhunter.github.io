<!DOCTYPE html>
<html> 
<head> 
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<style type="text/css">
      html { height: 100% }
      body { height: 100%; margin: 0px; padding: 0px }
      #map_canvas { height: 100%; z-index: 0;}
      #gmnoprint {width: auto;}
</style>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/> 
<title>Initiative Gaming Archeage Map</title> 
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>

<script>
// Array for markers

var markerArray = [];

//--- PREPARE THE XML! ---

if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.open("GET","markers.xml",false);
xmlhttp.send();
xmlDoc=xmlhttp.responseXML;

var xmlMarkers = xmlDoc.getElementsByTagName("marker");

// --- PUT SHIT IN OBJECTS TO USE LATER! ---

for(i=0;i<xmlMarkers.length;i++){
	console.log("shit");
	
	var newMarker = {
		title:xmlDoc.getElementsByTagName("title")[i].childNode[0].nodeValue,
		info:xmlDoc.getElementsByTagName("info")[i].childNode[0].nodeValue,
		icon:xmlDoc.getElementsByTagName("icon")[i].childNode[0].nodeValue,
		x:xmlDoc.getElementsByTagName("x")[i].childNode[0].nodeValue,
		y:xmlDoc.getElementsByTagName("y")[i].childNode[0].nodeValue
	};
	
	markerArray.push(newMarker);
	
}

</script>

<script>
// --- MAP SCRIPT ---
function CustomMapType() {
}
CustomMapType.prototype.tileSize = new google.maps.Size(256,256);
CustomMapType.prototype.maxZoom = 7;
CustomMapType.prototype.getTile = function(coord, zoom, ownerDocument) {
    var div = ownerDocument.createElement('DIV');
    var baseURL = 'http://terminalhunter.github.io/Initiative/map/';
    baseURL += zoom + '_' + coord.x + '_' + coord.y + '.png';
    div.style.width = this.tileSize.width + 'px';
    div.style.height = this.tileSize.height + 'px';
    div.style.backgroundColor = '#FFFFFF';
    div.style.backgroundImage = 'url(' + baseURL + ')';
    return div;
};

CustomMapType.prototype.name = "Custom";
CustomMapType.prototype.alt = "Tile Coordinate Map Type";
var map;
var CustomMapType = new CustomMapType();

// --- EW, HARDCODED MAP COORDS ---

var GuildHallCoords = new google.maps.LatLng(62.31900278603092, -106.4794921875);
var SpoonsFarmCoords = new google.maps.LatLng(60.21799073323445, -117.09228515625);
var ThatOtherGuyFarmCoords = new google.maps.LatLng(60.22799073323445, -116.455078125);
var TerminalFarmCoords = new google.maps.LatLng(64.23, -84.2431640625);

// --- MAP INIT ---

function initialize() {
  var mapOptions = {
      minZoom: 2,
    maxZoom: 7,
    isPng: true,
      mapTypeControl: false,
      streetViewControl: false,
        center: GuildHallCoords,     
      zoom: 6,
    mapTypeControlOptions: {
      mapTypeIds: ['custom', google.maps.MapTypeId.ROADMAP],
      style: google.maps.MapTypeControlStyle.DROPDOWN_MENU
    }
  };
map = new google.maps.Map(document.getElementById("map_canvas"),mapOptions);
map.mapTypes.set('custom',CustomMapType);
map.setMapTypeId('custom');

// --- Icon Images --- 

var exclamation = 'icons/ex-icon.png';
var plant = 'icons/plant-icon.png';

// --- EW, HARDCODED MAP MARKERS ---

//var GuildHouseMarker = new google.maps.Marker({
//	position: GuildHallCoords,
//	map: map,
//	title: 'Guild House',
//	icon: exclamation
//});

var SpoonMarker = new google.maps.Marker({
	position: SpoonsFarmCoords,
	map: map,
	title: "Spoons' farms",
	icon: plant
});

var OtherMarker = new google.maps.Marker({
	position: ThatOtherGuyFarmCoords,
	map: map,
	title: 'Other farm',
	icon: plant
});

var TerminalMarker = new google.maps.Marker({
	position: TerminalFarmCoords,
	map: map,
	title: "Terminal's Farm",
	icon: plant
});

//var infowindow1 = new google.maps.InfoWindow({
//	content: "The Guild House and Chests<br><br>1x Swept Roof Villa"
//});

var infowindow2 = new google.maps.InfoWindow({
	content: "Spoons' Farms<br><br>1x Large Farm<br>1x Small Farm"
});

var infowindow3 = new google.maps.InfoWindow({
	content: "Alverna's farm<br><br>1x Large Farm"
});

var infowindow4 = new google.maps.InfoWindow({
	content: "Terminal's farm - not set to guild, so ask before using<br><br>1x Small Farm"
});

//google.maps.event.addListener(GuildHouseMarker, 'click', function(){
//	infowindow1.open(map,GuildHouseMarker);
//});

google.maps.event.addListener(SpoonMarker, 'click', function(){
	infowindow2.open(map,SpoonMarker);
});

google.maps.event.addListener(OtherMarker, 'click', function(){
	infowindow3.open(map,OtherMarker);
});

google.maps.event.addListener(TerminalMarker, 'click', function(){
	infowindow4.open(map,TerminalMarker);
});

google.maps.event.addListener(map, 'click', function(e){
	console.log(e.latLng.toString());
});

}
</script>

</head> 


<body onload="initialize()"> 
<div id="static" style="position: fixed;">Map is mostly under construction and may not work at any given time...</div>
<div id="map_canvas" style="background: #1B2D33;"></div> 
</body>
</html> 